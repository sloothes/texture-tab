<script>

    (function(){
        var component_ID = {
            type: "tab",
            demo: false,
            version: 2.1,
            kind: "component",
            name: "insert.html",
            path: "/texture-tab/insert.html",
            description: "inserts new texture in zangoDB.",
        };
    })();

</script>

<div class="helpers-header texture-header">
    <h2 style="margin-bottom:20px;">Texture:</h2>
</div>

<div id="material-texture-viewer" style="width:100%;text-align:center;margin-bottom:20px;">
    <img id="material-texture-preview" width="290" height="290" style="margin:auto;">
</div>

<div style="height:45px;margin-bottom:10px;">
    <select id="imported-textures" class="form-control material-texture-droplist" readonly>
        <option value="">Select imported texture:</option>
    </select>
</div>

<div id="material-texture-controls" class="well" style="background:none;border-radius:8px;height:auto;display:none;">

    <h4 class="texture-checkbox-helper">
        <span style="vertical-align:-0.7rem;">Map:</span>
        <input type="checkbox" id="map" class="form-control pull-right material-checkbox material-texture-checkbox">
    </h4>
    <h4 class="texture-checkbox-helper">
        <span style="vertical-align:-0.7rem;">BumpMap:</span>
        <input type="checkbox" id="bumpMap" class="form-control pull-right material-checkbox material-texture-checkbox">
    </h4>
    <h4 class="texture-checkbox-helper">
        <span style="vertical-align:-0.7rem;">EmissiveMap:</span>
        <input type="checkbox" id="emissiveMap" class="form-control pull-right material-checkbox material-texture-checkbox">
    </h4>
    <h4 class="texture-checkbox-helper">
        <span style="vertical-align:-0.7rem;">MetalnessMap:</span>
        <input type="checkbox" id="metalnessMap" class="form-control pull-right material-checkbox material-texture-checkbox">
    </h4>
    <h4 class="texture-checkbox-helper">
        <span style="vertical-align:-0.7rem;">RoughnessMap:</span>
        <input type="checkbox" id="roughnessMap" class="form-control pull-right material-checkbox material-texture-checkbox">
    </h4>
    <h4 class="texture-checkbox-helper">
        <span style="vertical-align:-0.7rem;">DisplacementMap:</span>
        <input type="checkbox" id="displacementMap" class="form-control pull-right material-checkbox material-texture-checkbox">
    </h4>
    <h4 class="texture-checkbox-helper">
        <span style="vertical-align:-0.7rem;">AOMap:</span>
        <input type="checkbox" id="aoMap" class="form-control pull-right material-checkbox material-texture-checkbox">
    </h4>
    <h4 class="texture-checkbox-helper">
        <span style="vertical-align:-0.7rem;">AlphaMap:</span>
        <input type="checkbox" id="alphaMap" class="form-control pull-right material-checkbox material-texture-checkbox">
    </h4>
    <h4 class="texture-checkbox-helper">
        <span style="vertical-align:-0.7rem;">LightMap:</span>
        <input type="checkbox" id="lightMap" class="form-control pull-right material-checkbox material-texture-checkbox">
    </h4>
    <h4 class="texture-checkbox-helper">
        <span style="vertical-align:-0.7rem;">NormalMap:</span>
        <input type="checkbox" id="normalMap" class="form-control pull-right material-checkbox material-texture-checkbox">
    </h4>

</div>

<div style="margin-bottom:20px;">
    <input id="texture-fileinput" type="file" class="hidden" multiple>
    <div id="clear-imported-textures" class="form-control btn btn-danger btn-white-outline gradient-btn pull-left" style="width:24%;">Clear</div>
    <div id="import-texture-button" class="form-control btn btn-info btn-white-outline gradient-btn" style="width:50%;margin:0 1%;">Import textures</div>
    <div id="delete-selected-texture" class="form-control btn btn-success btn-white-outline gradient-btn pull-right" style="width:24%;">Delete</div>
    <div id="upload-material-textures" class="form-control btn btn-success btn-white-outline gradient-btn pull-right hidden" style="width:24%;">Upload</div>
</div>

<hr/>

<script>

(function(){

    const textureHeaderSelector = ".texture-header";
    const helpersHeaderSelector = ".helpers-header";
    const textureControlSelector = "#material-texture-controls";

    var Signal = signals.Signal;
    var dblclicked = new Signal();

//  Event handlers.
    function onDoubleClickEventHandler( element ){
        if ( $(element).css("display") == "none" ) {
            $(element).slideDown();
        } else {
            $(element).slideUp();
        }
    }

//  Event listeners.
    dblclicked.add(onDoubleClickEventHandler);

//  Dispatch events.
    $(textureHeaderSelector).on("dblclick", function(){
        dblclicked.dispatch( $(textureControlSelector).get(0) );
    });

})();

</script>

<script>

(function(){

/*
//  const VERSION = 4;
    const NAME = "USER";

    var db = new zango.Db( NAME, {
        animations: true,
        outfits:    true,
        materials:  true,
        textures:   true,
        products:   true,
    });

    db.open(function(err, database){
        if (err) console.error(err);
    }).then( function(){
        debugMode && console.log(`Database ${db.name} (v${db.version}) opened.`);
    }).catch(function(err){
        console.error(err);
    });
*/

    var files = {};
    var uploads = [];
    var textures = {};

    const viewer = document.getElementById("viewer");
    const textureImportBtn = $("#import-texture-button").get(0);
    const textureFileinput = $("input#texture-fileinput").get(0);
    const textureDeleteBtn = $("#delete-selected-texture").get(0);
    const texturesClearBtn = $("#clear-imported-textures").get(0);
    const textureUploadBtn = $("#upload-material-textures").get(0);
    const textureDroplist  = $("select#imported-textures").get(0);
    const textureControls  = $("#material-texture-controls").get(0);

    const textureControlSelector = "#material-texture-controls";
    const textureCheckboxSelector = "input[type=checkbox].material-texture-checkbox";

    var THREE = viewer.contentWindow.THREE; // important!

    function generateUUID(){
        return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx"
        .replace(/[xy]/g, function(c) {
            var r = Math.random()*16|0;
            var v = c == 'x'?r:r&0x3|0x8;
            return v.toString(16);
        }).toLocaleUpperCase();
    }




















})();

</script>
